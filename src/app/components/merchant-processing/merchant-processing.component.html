<form [formGroup]="merchantProcessingProfileForm" (onSubmit)="submitMerchProc($event)">
  <div class="row">
    <div class="col-5 no-pad right-pad-15">
      <label for="sourcetypesb2c" class="row">% Business to Consumer (B2C)</label>
      <div class="row">
        <kendo-numerictextbox [min]="0" [max]="100" tabindex="0" title="B2C" formControlName="B2C" [step]="step"
          (valueChange)="onValueChange($event, 'B2C')" [autoCorrect]="autoCorrect" [decimals]="decimals"
          [format]="format"
          [ngClass]="{'has-danger': merchantProcessingProfileForm.get('B2C').hasError('required') && merchantProcessingProfileForm.get('B2C').touched }">
        </kendo-numerictextbox>
        <span class="error-text" *ngIf="merchantProcessingProfileForm.get('B2C').errors
               && merchantProcessingProfileForm.get('B2C').touched
               || merchantProcessingProfileForm.get('B2C').dirty">
          <span class="error-text numeric-error warning-icon"
            *ngIf="merchantProcessingProfileForm.get('B2C').hasError('required')">% of B2C is required field.</span>
        </span>
      </div>
    </div>
    <div class="col-5 no-pad">
      <label class="sourcetypesb2b" class="row">% Business to Business (B2B)</label>
      <div class="row">
        <kendo-numerictextbox [min]="0" [max]="100" tabindex="0" title="B2B" formControlName="B2B" [step]="step"
          (valueChange)="onValueChange($event, 'B2B')" [autoCorrect]="autoCorrect" [decimals]="decimals"
          [format]="format"
          [ngClass]="{'has-danger': merchantProcessingProfileForm.get('B2B').hasError('required') && merchantProcessingProfileForm.get('B2B').touched }">
        </kendo-numerictextbox>
        <span class="error-text" *ngIf="merchantProcessingProfileForm.get('B2B').errors
               && merchantProcessingProfileForm.get('B2B').touched
               || merchantProcessingProfileForm.get('B2B').dirty">
          <span class="error-text numeric-error warning-icon"
            *ngIf="merchantProcessingProfileForm.get('B2B').hasError('required')">% of B2B is required field.</span>
        </span>
      </div>

    </div>
  </div>

  <div class="row form-row">
    <div class="row">
      <label for="mcc_tax_id" class="row form-row">Merchant Category Code (MCC)</label>
      <kendo-autocomplete #mccSrc formControlName="mccCodeContent" [data]="mccSrcList"
        [placeholder]="'Please enter MCC Code'" class="input-txt-90w" [filterable]="true"
        (valueChange)="mccValueChange($event)" (filterChange)="mccFinderInput($event)" (keydown)="mccSrcKeydown($event)"
        (keypress)="omit_special_char($event)" (click)="showMCCDisablePopup = true">
      </kendo-autocomplete>
      <span class="ico-mcc-merchant"><img #src src="assets/img/binoculars.png" title="Search MCC Code"
          (click)="openMcciBox(src)"></span>
      <span class="error-text" *ngIf="dbaLengthChck"><span class="error-icon"> DBA Length exceeds 19 characters. Please
          correct it <a (click)="DBANameFix()">Click Here</a></span></span>
    </div>
    <kendo-dialog title='' [width]="'100%'" [height]="84" *ngIf="closeMCCfinder" [minWidth]="150" [minHeight]="50"
      [width]="150" class="message-dialog-container">
      <div class="message-dialog">
        <span class="k-icon k-i-info" ng-reflect-klass="k-icon" ng-reflect-ng-class="k-i-info"></span>
        <p>Are you sure you want to close MCC Finder?</p>
        <button kendoButton (click)="closeDialogAction('ok')" class="btn-secondary">OK</button>
        <button kendoButton (click)="closeDialogAction('cancel')" class="btn-secondary">Cancel</button>
      </div>
    </kendo-dialog>
  </div>
  <hr class="hr-line">
  <div class="row">
    <div class="col-5 no-pad right-pad-15">
      <label for="AverageTicket" class="row form-row">Average Ticket (in USD)</label>
      <div class="row">
        <kendo-numerictextbox [format]="'c2'" [spinners]="false" formControlName="AverageTicket" tabindex="0"
          autocomplete="off" (keydown)="validateInputOnKeydown($event)" (keyup)="averageTicketKeyup()" [min]="0"
          placeholder="$0.00" id="AverageTicket" title="Average Ticket" class="numTxtBox input-text-100w"
          [ngClass]="{'has-danger': merchantProcessingProfileForm.get('AverageTicket').hasError('required') && merchantProcessingProfileForm.get('AverageTicket').touched }">
        </kendo-numerictextbox>
        <span class="error-text" *ngIf="merchantProcessingProfileForm.get('AverageTicket').errors
               && merchantProcessingProfileForm.get('AverageTicket').touched
               || merchantProcessingProfileForm.get('AverageTicket').dirty">
          <span class="error-text"
            *ngIf="merchantProcessingProfileForm.get('AverageTicket').hasError('required')">Average Ticket is
            required</span>
          <span class="error-text" *ngIf="isAverageTicketValueMSG && averageTicketTimes > 0"><span
              class="error-icon">Annual Visa / Master Card cannot be less than Average Ticket.</span></span>
        </span>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-5 no-pad right-pad-15">
      <label for="card_pres" class="row form-row">% Card Present (CP)</label>
      <div class="row">
        <kendo-numerictextbox [value]="value" [min]="0" [max]="100" [autoCorrect]="autoCorrect" id="card_pres"
          tabindex="0" title="Card Present" formControlName="CardPresent" [step]="step" [decimals]="decimals"
          [format]="format" (valueChange)="onValueChange($event, 'CardPresent')" aria-required="true"
          [ngClass]="{'has-danger': merchantProcessingProfileForm.get('CardPresent').hasError('required') && merchantProcessingProfileForm.get('CardPresent').touched }">
        </kendo-numerictextbox>
        <span class="error-text" *ngIf="merchantProcessingProfileForm.get('CardPresent').errors
               && merchantProcessingProfileForm.get('CardPresent').touched
               || merchantProcessingProfileForm.get('CardPresent').dirty">
          <span class="error-text numeric-error warning-icon"
            *ngIf="merchantProcessingProfileForm.get('CardPresent').hasError('required')">% Card Present is required
            field.</span>
        </span>
      </div>

    </div>
    <div class="col-5 no-pad">
      <label for="card_not_pres" class="row form-row">% Card Not Present (CNP)</label>
      <div class="row">
        <kendo-numerictextbox [value]="value" [min]="0" [max]="100" [autoCorrect]="autoCorrect" id="card_no_pres"
          title="Card Not Present" tabindex="0" aria-required="true" formControlName="CardNotPresent"
          (valueChange)="onValueChange($event, 'CardNotPresent')" [step]="step" [decimals]="decimals" [format]="format">
        </kendo-numerictextbox>
        <span class="error-text" *ngIf="merchantProcessingProfileForm.get('CardNotPresent').errors
               && merchantProcessingProfileForm.get('CardNotPresent').touched
               || merchantProcessingProfileForm.get('CardNotPresent').dirty">
          <span class="error-text numeric-error warning-icon"
            *ngIf="merchantProcessingProfileForm.get('CardNotPresent').hasError('required')">% Card Not Present is
            required field.</span>
        </span>
      </div>
    </div>
  </div>
  <div role="group" aria-labelledby="aria-group-legend">
    <label class="row form-row bottom-pad-10">Does the merchant process 100% of their transactions over the
      internet?</label>
    <div class="row-20">
      <input type="radio" name="TransactionSource" [value]="true" formControlName="TransactionSource" id="t1"
        tabindex="0" kendoRadioButton /><label for="t1" class="lable-normal"> Yes</label>
    </div>
    <div class="row-20">
      <input type="radio" name="TransactionSource" [value]="false" formControlName="TransactionSource" id="t2"
        tabindex="0" kendoRadioButton /><label for="t2" class="lable-normal"> No </label>
    </div>
  </div>
  <div class="row">
    <div class="col-5 no-pad right-pad-15">
      <label for="proc_type" class="row form-row">Processing Type</label>
      <div class="row">
        <kendo-dropdownlist formControlName="ProcessingType" [data]="processingTypes"
          [attr.disabled]="disableTypeOption" [defaultItem]="processingTypeDefaultItem" [textField]="'name'"
          [valueField]="'code'" [valuePrimitive]="true" (selectionChange)="processingTypeChanged($event)"
          (click)="fetchProcessingType()" aria-required="true" tabindex="0">
        </kendo-dropdownlist>
      </div>
    </div>
    <div class="col-5 no-pad">
      <label class="row form-row">Processing Option</label>
      <div class="row">
        <kendo-dropdownlist formControlName="ProcessingOption" [data]="processingOptions"
          [attr.disabled]="disableTypeOption" [defaultItem]="processingOptionDefaultItem" [textField]="'name'"
          [valueField]="'code'" [valuePrimitive]="true" (selectionChange)="processingOptionChanged($event)"
          (click)="fetchProcessingOption()" aria-required="true" tabindex="0">
        </kendo-dropdownlist>
      </div>
    </div>
  </div>
  <div class="row form-row">
    <div role="group" aria-labelledby="aria-group-legend">
      <label class="row form-row bottom-pad-10">Communication Method</label>
      <div class="row bottom-pad-10">
        <input type="radio" name="CommunicationMethod" [value]="communicationOption[0]"
          [attr.disabled]="communicationWithoutRules" (change)="communicationMethodChanged('Dial')"
          formControlName="CommunicationMethod" id="n1" tabindex="0" kendoRadioButton /><label for="n1"
          class="lable-normal">
          Dial (A)</label>
      </div>
      <div class="row bottom-pad-10">
        <input type="radio" name="CommunicationMethod" [value]="communicationOption[1]"
          [attr.disabled]="communicationWithoutRules" (change)="communicationMethodChanged('Frame-Relay')"
          formControlName="CommunicationMethod" id="n2" tabindex="0" kendoRadioButton /><label for="n2"
          class="lable-normal">
          Frame Relay (C) </label>
      </div>
      <div class="row bottom-pad-10">
        <input type="radio" name="CommunicationMethod" [value]="communicationOption[2]"
          [attr.disabled]="communicationWithRules" (change)="communicationMethodChanged('Frame-Internet')"
          formControlName="CommunicationMethod" id="n3" tabindex="0" kendoRadioButton /><label for="n3"
          class="lable-normal"> Frame/Internet (M)</label>
      </div>
      <div class="row bottom-pad-10">
        <input type="radio" name="CommunicationMethod" [value]="communicationOption[3]"
          [attr.disabled]="communicationWithoutRules" (change)="communicationMethodChanged('Datawire')"
          formControlName="CommunicationMethod" id="n4" tabindex="0" kendoRadioButton /><label for="n4"
          class="lable-normal">
          Datawire (IPN)</label>
      </div>
      <div class="row bottom-pad-10">
        <input type="radio" name="CommunicationMethod" [value]="communicationOption[4]"
          [attr.disabled]="communicationWithoutRules" (change)="communicationMethodChanged('Lease')"
          formControlName="CommunicationMethod" id="n5" tabindex="0" kendoRadioButton /><label for="n5"
          class="lable-normal">
          Lease (M)</label>
      </div>
    </div>
  </div>
  <hr class="hr-line">
  <div class="row">
    <table class="table-textbox-style">
      <tr>
        <td class="bottom-border lable-col-1-top"><label class="td-label">Annual Estimated Processing Volume</label>
        </td>
        <td class="bottom-border input-col-2"> <label>${{ getControlLabel('TotalAnnualVolume') | number : '1.2-2'}}
          </label> </td>
        <td class="bottom-border button-col-3"></td>
      </tr>
      <tr>
        <td colspan="3" class="table-td-holder">
          <table width="100%">
            <tr>
              <td class="lable-col-1"><label class="td-label-icon">Annual Visa / Master Card</label></td>
              <td class="input-col-2">
                <span class="confirm-text" *ngIf="isConfirmVolume">&#10004;</span>
                <kendo-numerictextbox [format]="'c2'" [spinners]="false" [readonly]="annualVisaFlag"
                  formControlName="VisaOrMasterCard" tabindex="0" autocomplete="off"
                  (keydown)="validateInputOnKeydown($event)" (keyup)="setVisaOrMasterVolume()" placeholder="$0.00"
                  [min]="0" kendoTextBox id="VisaOrMasterCard" title="Annual Visa/Master Card" aria-required="true"
                  tabindex="0" [ngClass]="{'has-danger': merchantProcessingProfileForm.get('VisaOrMasterCard').hasError('required') &&
                      merchantProcessingProfileForm.get('VisaOrMasterCard').touched }">
                </kendo-numerictextbox>
                <span class="confirm-text" *ngIf="isConfirmVolume">&#10004;</span>
                <span class="error-text" *ngIf="merchantProcessingProfileForm.get('VisaOrMasterCard').errors
                        && merchantProcessingProfileForm.get('VisaOrMasterCard').touched
                        || merchantProcessingProfileForm.get('VisaOrMasterCard').dirty">
                  <span class="error-text annual-visa-error"
                    *ngIf="merchantProcessingProfileForm.get('VisaOrMasterCard').hasError('required')">Annual Visa /
                    Master Card is required field</span>
                  <span class="error-text annual-visa-error warning-icon" *ngIf="isAnnualVisaMasterCardMSG ">Annual Visa
                    / Master Card cannot be less than Average Ticket.</span>
                </span>
              </td>
              <td class="border-none button-col-3">
                <span><a href="javascript: void(0);" *ngIf="!isConfirmVolume"
                    (click)="onClickConfirmEdit(true)">Confirm</a></span>
                <span><a href="javascript: void(0);" *ngIf="isConfirmVolume"
                    (click)="onClickConfirmEdit(false)">Edit</a></span>
              </td>
            </tr>
            <tr>
              <td><label class="td-label-icon">Discover</label></td>
              <td class="input-col-2 right-pad-10">
                <label>${{ getControlLabel('Discover') | number : '1.2-2'}} </label>
              </td>
              <td class="border-none"></td>
            </tr>
            <tr>
              <td>
                <div class="bottom-pad-10">
                  <label class="td-label-bold-icon">American Express</label>
                </div>
                <div class="bottom-pad-10 left-pad-25">
                  <label class="td-label-without-icon">Does the Merchant accept American Express?</label><br>
                </div>
                <div role="group" aria-labelledby="aria-group-legend" class="left-pad-25">
                  <input formControlName="AcceptAmericanExpress" type="radio" name="AcceptAmericanExpress" tabindex="0"
                    [value]=true (change)="changeAmericanExpressSelected(true)" kendoRadioButton />
                  <label for="amex1"> Yes </label>
                  <input formControlName="AcceptAmericanExpress" type="radio" name="AcceptAmericanExpress" tabindex="0"
                    [value]=false (change)="changeAmericanExpressSelected(false)" kendoRadioButton />
                  <label for="amex2"> No </label>
                  <span class="error-text" *ngIf="merchantProcessingProfileForm.get('AcceptAmericanExpress').errors
                && merchantProcessingProfileForm.get('AcceptAmericanExpress').touched
                || merchantProcessingProfileForm.get('AcceptAmericanExpress').dirty">
                    <span class="checkbox-message"
                      *ngIf="merchantProcessingProfileForm.get('AcceptAmericanExpress').hasError('required')">Please
                      select one of these options.</span>
                  </span>
                </div>
              </td>
              <td valign="top" class="input-col-2">
                <div *ngIf="!AcceptAmericanExpress" class="right-pad-10">
                  <label>${{ getControlLabel('AmericanExpress') | number : '1.2-2'}}</label>
                </div>
                <div *ngIf="AcceptAmericanExpress">
                  <kendo-numerictextbox [format]="'c2'" [spinners]="false" formControlName="AmericanExpress" class=""
                    placeholder="$0.00" tabindex="0" autocomplete="off" (keydown)="validateInputOnKeydown($event)"
                    (keyup)="calculateAnnualAmexVolumeKeyup()" (keypress)="omit_special_char($event)" kendoTextBox
                    id="AmericanExpress" title="American Expresse" aria-required="true" [ngClass]="{'has-danger': merchantProcessingProfileForm.get('AmericanExpress').hasError('required') &&
                      merchantProcessingProfileForm.get('AmericanExpress').touched }">
                  </kendo-numerictextbox>
                  <span class="error-text" *ngIf="merchantProcessingProfileForm.get('AmericanExpress').errors
                        && merchantProcessingProfileForm.get('AmericanExpress').touched
                        || merchantProcessingProfileForm.get('AmericanExpress').dirty">
                    <span class="error-text"
                      *ngIf="merchantProcessingProfileForm.get('AmericanExpress').hasError('required')">American
                      Express is required field</span>
                  </span>
                </div>
              </td>
              <td class="border-none"></td>
            </tr>
            <tr>
              <td class="border-none"><label class="td-label-icon">PIN Debit Volume</label></td>
              <td class="border-none input-col-2">
                <kendo-numerictextbox [format]="'c2'" [spinners]="false" formControlName="PinDebitVolume" class=""
                  (keydown)="validateInputOnKeydown($event)" (keyup)="calculateAnnualEstimatedProcessingVolume()"
                  kendoTextBox id="PinDebitVolume" title="Pin Debit Volume" placeholder="$0.00" [min]="0"
                  autocomplete="off" tabindex="0" [ngClass]="{'has-danger': merchantProcessingProfileForm.get('PinDebitVolume').hasError('required') &&
              merchantProcessingProfileForm.get('PinDebitVolume').touched }">
                </kendo-numerictextbox>
                <span class="error-text" *ngIf="merchantProcessingProfileForm.get('PinDebitVolume').errors
                && merchantProcessingProfileForm.get('PinDebitVolume').touched
                || merchantProcessingProfileForm.get('PinDebitVolume').dirty">
                  <span class="error-text annual-visa-error"
                    *ngIf="merchantProcessingProfileForm.get('PinDebitVolume').hasError('required')">Pin Debit Volume is
                    required field</span>
                </span>
              </td>
              <td class="border-none"></td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </div>
  <div class="row">
    <label for="loc" class="row form-row">
      <div id='loc'>Does the merchant have multiple locations?</div>
    </label>
    <div class="row-20">
      <input type="radio" name="location" [value]="!isLocSelected" formControlName="location" id='mul1'
        (click)="numOfLocation(true)" (change)="isLocationFunc(false)" kendoRadioButton /><label for="mul1"> Yes </label>
    </div>
    <div class="row-20">
      <input type="radio" name="location" [value]="isLocSelected" formControlName="location" id='mul2'
        (click)="numOfLocation(false)" kendoRadioButton /><label for="mul2"> No </label>
    </div>
  </div>
  <div class="row" *ngIf="isLocSelected">
    <div class="col-3 no-pad">
      <label for="locations" class="row form-row">
        <div id='locations'>Number of Locations</div>
      </label>
      <div class="row">
        <kendo-numerictextbox type="number" [format]="'null'" [value]="value" [min]="1" [max]="100" tabindex="0"
          formControlName="numeric" [autoCorrect]="autoCorrect" [attr.disabled]="isLocDisabled? true: false">
        </kendo-numerictextbox>
      </div>
    </div>
  </div><br />
</form>
<kendo-dialog title="Merchant Category Code (MCC) Finder" *ngIf="mcciDialogOpened" (close)="closeMcciBox()"
  [width]="820" [height]="634">
  <!-- Temporary sending hardcoded values for testing, later will bind with value from controller -->
  <app-mcc-finder #mccFinder [b2bOption]="b2bVal" [b2cOption]="b2cVal" (selectedMccRow)="popupSelectedMcc($event)">
  </app-mcc-finder>
</kendo-dialog>
<kendo-dialog title='' [width]="'100%'" [height]="84" *ngIf="closeMCCfinder" [minWidth]="150" [minHeight]="50"
  [width]="150" class="message-dialog-container">
  <div class="message-dialog">
    <span class="k-icon k-i-info" ng-reflect-klass="k-icon" ng-reflect-ng-class="k-i-info"></span>
    <p>Are you sure you want to close MCC Finder?</p>
    <button kendoButton (click)="closeDialogAction('ok')" class="btn-secondary">OK</button>
    <button kendoButton (click)="closeDialogAction('cancel')" class="btn-secondary">Cancel</button>
  </div>
</kendo-dialog>
<kendo-dialog title='' [width]="'100%'" [height]="84" *ngIf="isCommunicationError" [minWidth]="150" [minHeight]="50"
  [width]="150" class="message-dialog-container">
  <div class="message-dialog">
    <span class="k-icon k-i-info" ng-reflect-klass="k-icon" ng-reflect-ng-class="k-i-info"></span>
    <p>You cannot change selected communication type</p>
    <button kendoButton (click)="closeCommunicationError()" class="btn-secondary">OK</button>
  </div>
</kendo-dialog>
<kendo-dialog title='' [width]="'100%'" *ngIf="showNotification" [minWidth]="520" [minHeight]="50" [width]="140"
  class="message-dialog-container">
  <div class="message-dialog">
    <span class="k-icon k-i-info" ng-reflect-klass="k-icon" ng-reflect-ng-class="k-i-info"></span>
    <p>{{notificationMsg}}</p>
    <button kendoButton (click)="showNotification = false" class="btn-secondary">OK</button>
  </div>
</kendo-dialog>
<div *ngIf="showLoader" class="k-i-loading"></div>
<kendo-dialog title='' [width]="'100%'" *ngIf="showLocationMsg" [minWidth]="520" [minHeight]="50" [width]="140"
  class="message-dialog-container-2">
  <div class="message-dialog">
    <span class="k-icon k-i-info" ng-reflect-klass="k-icon" ng-reflect-ng-class="k-i-info"></span>
    <p>Currently system supports one location per merchant.</p>
    <button kendoButton (click)="closeWarningForLocation()" class="btn-secondary">OK</button>
  </div>
</kendo-dialog>
<kendo-dialog title='' [width]="'100%'" *ngIf="showMCCDisablePopup && isMCCENoteditable" [minWidth]="520"
  [minHeight]="50" [width]="140" class="message-dialog-container-2">
  <div class="message-dialog">
    <span class="k-icon k-i-info" ng-reflect-klass="k-icon" ng-reflect-ng-class="k-i-info"></span>
    <p>Please provide B2B or B2C to enable Merchant Category Code</p>
    <button kendoButton (click)="showMCCDisablePopup = false" class="btn-secondary">OK</button>
  </div>
</kendo-dialog>